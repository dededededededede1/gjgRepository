# servlet 的转发

当我们谈论Servlet之间的转发，我们通常是指将请求从一个Servlet转发到另一个Servlet进行处理。Java Servlet技术中，我们通常使用`RequestDispatcher`对象来实现请求转发。以下是一个简单的示例，说明了如何在两个Servlet之间进行转发。

假设我们有两个Servlet类：`FirstServlet`和`SecondServlet`。 
1. `FirstServlet`：接收请求并将其转发到`SecondServlet`进行处理。 
2. `SecondServlet`：接收来自`FirstServlet`的请求，执行逻辑处理，然后将结果返回给客户端。

首先，我们需要在`web.xml`文件中配置这两个Servlet：

```xml

<web-app>
  <servlet>
    <servlet-name>FirstServlet</servlet-name>
    <servlet-class>com.example.FirstServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>FirstServlet</servlet-name>
    <url-pattern>/first</url-pattern>
  </servlet-mapping>

  <servlet>
    <servlet-name>SecondServlet</servlet-name>
    <servlet-class>com.example.SecondServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>SecondServlet</servlet-name>
    <url-pattern>/second</url-pattern>
  </servlet-mapping>
</web-app>
```



接下来，我们来编写`FirstServlet`类：

```java

package com.example;

import java.io.IOException;
import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class FirstServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // 设置请求属性
        request.setAttribute("message", "Hello from FirstServlet!");

        // 获取RequestDispatcher对象
        RequestDispatcher dispatcher = request.getRequestDispatcher("/second");

        // 将请求转发到SecondServlet
        dispatcher.forward(request, response);
    }
}
```



然后，我们编写`SecondServlet`类：

```java

package com.example;

import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class SecondServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // 获取来自FirstServlet的请求属性
        String message = (String) request.getAttribute("message");

        // 设置响应内容类型和编码
        response.setContentType("text/html;charset=UTF-8");

        // 输出响应结果
        response.getWriter().println("<h1>" + message + "</h1>");
        response.getWriter().println("<p>This message is from SecondServlet.</p>");
    }
}
```



当用户访问`/first` URL时，请求将被发送到`FirstServlet`，然后`FirstServlet`将请求转发到`SecondServlet`。`SecondServlet`处理请求，执行逻辑处理，并返回结果给客户端。

这就是一个简单的Servlet转发案例。希望这个示例能帮助你更好地理

# servlet 的重定向

重定向与转发的主要区别在于，重定向会向客户端发送一个新的URL，并使客户端发起新的请求，而转发是在服务器端完成的，客户端并不知道实际处理请求的是另一个Servlet。

以下是一个简单的示例，说明了如何在两个Servlet之间进行重定向。

假设我们有两个Servlet类：`FirstServlet`和`SecondServlet`。 
1. `FirstServlet`：接收请求并将其重定向到`SecondServlet`进行处理。 
2. `SecondServlet`：接收来自`FirstServlet`的重定向请求，执行逻辑处理，然后将结果返回给客户端。

我们仍然使用前面示例中的`web.xml`配置。

接下来，我们来编写`FirstServlet`类：

```java

package com.example;

import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class FirstServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // 设置响应状态码和重定向的目标URL
        response.setStatus(HttpServletResponse.SC_MOVED_TEMPORARILY);
        response.setHeader("Location", request.getContextPath() + "/second");
    }
}
```



然后，我们编写`SecondServlet`类：

```java

package com.example;

import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class SecondServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // 设置响应内容类型和编码
        response.setContentType("text/html;charset=UTF-8");

        // 输出响应结果
        response.getWriter().println("<h1>Hello from SecondServlet!</h1>");
        response.getWriter().println("<p>This message is from SecondServlet after redirection from FirstServlet.</p>");
    }
}
```



当用户访问`/first` URL时，请求将被发送到`FirstServlet`，然后`FirstServlet`将请求重定向到`SecondServlet`。浏览器会收到一个新的URL，并发起新的请求到`SecondServlet`。`SecondServlet`处理重定向请求，执行逻辑处理，并返回结果给客户端。

这就是一个简单的Servlet重定向案例。希望这个示例能帮助你更好地理解Servlet之间的重定向。

### 转发和重定向的区别

- Servlet的转发和重定向都是在处理HTTP请求时使请求流向不同的Servlet的方法。然而，它们在实现和行为上有一些关键的区别： 

### 1、服务器端处理：

- 转发：在服务器端进行。请求从一个Servlet转发到另一个Servlet，客户端不知道这个过程。所有处理都在同一个请求和响应对象中完成。
- 重定向：涉及客户端。服务器向客户端发送一个新的URL，客户端需要发起新的请求以访问该URL。这意味着两个不同的请求和响应对象参与了整个过程。 

### 2、URL显示：

- 转发：客户端的URL地址栏不会改变，因为转发是在服务器端完成的，客户端并不知道实际处理请求的是另一个Servlet。
- 重定向：客户端的URL地址栏会显示新的URL，因为客户端需要发起新的请求。 

### 3、数据传递： 

- 转发：由于转发在服务器端进行，请求和响应对象可以在转发的Servlet之间共享。这意味着可以通过`request.setAttribute()`和`request.getAttribute()`在Servlet之间传递数据。
- 重定向：由于涉及新的请求和响应对象，Servlet之间不能直接共享数据。如果需要在Servlet之间传递数据，可以使用查询参数、session属性等方法。 

### 4、性能：

- 转发：由于所有处理都在服务器端完成，通常性能较好。
- 重定向：涉及客户端和额外的请求，性能可能较差。 

### 5、使用场景：

- 转发：当需要将请求处理委托给另一个Servlet，并保持请求和响应对象不变时，可以使用转发。例如，当一个Servlet负责预处理请求，另一个Servlet负责生成响应时。
- 重定向：当需要将客户端导向一个新的URL，例如在表单提交后避免重复提交时，可以使用重定向。

总之，Servlet转发和重定向是两种处理HTTP请求的方法，它们在实现、行为、数据传递、性能和使用场景上有明显的区别。在实际开发中，根据需求选择合适的方法非常重要。
